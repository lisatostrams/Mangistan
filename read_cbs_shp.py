#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue May 11 13:21:29 2021

@author: lisatostrams
"""
folder = 'data/data_overheid_wms/postcode_stats'

cbs_folder = '/Users/lisatostrams/Documents/LL14april/data/CBS-PC6-2017-v3'
file = '/CBS_PC6_2017_v3.shp'

import geopandas as gpd

gdf = gpd.read_file(cbs_folder+file)

gdf.index = gdf.Postcode
#%%


pc = ['1390', '1391', '1393', '1396', '1426', '1427', '3400', '3401',
       '3402', '3403', '3404', '3405', '3410', '3411', '3412', '3413',
       '3415', '3417', '3420', '3421', '3425', '3430', '3431', '3432',
       '3433', '3434', '3435', '3436', '3437', '3438', '3439', '3440',
       '3441', '3442', '3443', '3444', '3445', '3446', '3447', '3448',
       '3449', '3450', '3451', '3452', '3453', '3454', '3455', '3460',
       '3461', '3464', '3467', '3470', '3471', '3474', '3480', '3481',
       '3500', '3501', '3502', '3503', '3504', '3505', '3506', '3507',
       '3508', '3509', '3511', '3512', '3513', '3514', '3515', '3521',
       '3522', '3523', '3524', '3525', '3526', '3527', '3528', '3531',
       '3532', '3533', '3534', '3540', '3541', '3542', '3543', '3544',
       '3545', '3546', '3551', '3552', '3553', '3554', '3555', '3561',
       '3562', '3563', '3564', '3565', '3566', '3571', '3572', '3573',
       '3581', '3582', '3583', '3584', '3585', '3600', '3601', '3602',
       '3603', '3604', '3605', '3606', '3607', '3608', '3611', '3612',
       '3615', '3620', '3621', '3626', '3628', '3630', '3631', '3632',
       '3633', '3634', '3640', '3641', '3642', '3643', '3645', '3646',
       '3648', '3700', '3701', '3702', '3703', '3704', '3705', '3706',
       '3707', '3708', '3709', '3710', '3711', '3712', '3720', '3721',
       '3722', '3723', '3730', '3731', '3732', '3734', '3735', '3737',
       '3738', '3739', '3740', '3741', '3742', '3743', '3744', '3749',
       '3750', '3751', '3752', '3754', '3755', '3760', '3761', '3762',
       '3763', '3764', '3765', '3766', '3768', '3769', '3791', '3800',
       '3802', '3811', '3812', '3813', '3814', '3815', '3816', '3817',
       '3818', '3819', '3821', '3822', '3823', '3824', '3825', '3826',
       '3828', '3829', '3830', '3831', '3832', '3833', '3834', '3835',
       '3836', '3900', '3901', '3902', '3903', '3904', '3905', '3906',
       '3907', '3910', '3911', '3912', '3921', '3922', '3927', '3930',
       '3931', '3940', '3941', '3945', '3947', '3950', '3951', '3953',
       '3956', '3958', '3959', '3960', '3961', '3962', '3970', '3971',
       '3972', '3980', '3981', '3984', '3985', '3989', '3990', '3991',
       '3992', '3993', '3994', '3995', '3997', '3998', '3999', '4121',
       '4122', '4124', '4125', '4126', '4128', '4130', '4131', '4132',
       '4133', '4140', '4141', '4142', '4143', '4145', '4163', '4230',
       '4231', '4233', '4235', '4243', '4245', '4247']

gdf_utrecht = gpd.GeoDataFrame(columns=gdf.columns,crs=gdf.crs)
i=0
for p in pc:
    print("{:.2f}%".format(100*i/len(pc)))
    i+=1
    df_pc = gdf.filter(like=p, axis=0)
    gdf_utrecht = gdf_utrecht.append(df_pc)
    
#%%

gdf_utrecht.to_file("/Users/lisatostrams/Documents/LL14april/data/data_overheid_wms/postcode_stats.geojson", driver='GeoJSON')
#%%
import pandas as pd


df = pd.read_csv(cbs_folder+'/CBS_PC6_2017_v3.csv',error_bad_lines=False,sep=';',encoding = "UTF-8",index_col=0)

df_utrecht = gpd.GeoDataFrame(columns=df.columns)

for p in pc:
    df_pc = df.filter(like=p, axis=0)
    df_utrecht = df_utrecht.append(df_pc)
    
df_utrecht.to_csv(folder+'/postcode_stats.csv')



